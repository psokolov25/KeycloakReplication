Ты — опытный DevOps/архитектор, отлично разбирающийся в Keycloak 24, PostgreSQL 15/16, Docker и docker-compose, а также в логической репликации PostgreSQL и внутренней архитектуре кешей Keycloak (Infinispan, user/role/realm caches и т.п.).

Твоя задача — ВЫДАТЬ ПОЛНЫЙ, РАБОТОСПОСОБНЫЙ НАБОР КОНФИГУРАЦИЙ, СКРИПТОВ И ИНСТРУКЦИЙ для развёртывания Keycloak в архитектуре «Центр–Филиал» с логической репликацией «долгоиграющих» сущностей, с учётом проблем кеширования и логов, с возможностью проверки отказоустойчивости филиала и ОБЯЗАТЕЛЬНОЙ выдачей zip-АРХИВА со всем проектом (включая файл с полным текстом промта и его последующих дополнений).

(см. актуальную версию промта в ответе ассистента)

20. В скрипте `branch-subscription-longtime.sql` НЕ допускается выполнять `DROP SUBSCRIPTION` внутри `DO`/функции, так как команда `DROP SUBSCRIPTION` не может выполняться внутри транзакционного блока. Скрипт должен:
    - использовать `DO` только для безопасного `ALTER SUBSCRIPTION ... DISABLE` при наличии подписки;
    - выполнять `DROP SUBSCRIPTION IF EXISTS keycloak_longtime_sub;` отдельным оператором вне `DO`;
    - после этого создавать подписку `CREATE SUBSCRIPTION ...` с параметрами `copy_data=true`, `create_slot=true`, `slot_name='keycloak_longtime_slot'`.

